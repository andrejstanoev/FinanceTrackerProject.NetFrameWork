@model IEnumerable<FinanceTrackerProject.Models.Budget>

@{
    ViewBag.Title = "Budgets";
}

<style>
    .name{
        margin-top:30px;
        margin-bottom:30px
    }

    .containerce {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        border: 1px dashed black;
/*        width: 350px;
        height: 160px;*/
        width:fit-content;
        border-radius: 20px;
        cursor: pointer;
        padding:10px;
        background-color: rgb(239, 238, 238);
        transition: all 0.3s;
        box-shadow: 1px 1px 10px rgba(0, 0, 0, 0.1), -1px -1px 10px rgba(0, 0, 0, 0.1);
    }
    a:hover {
        color: inherit; 
        text-decoration: none;

    }
    .containerce:hover {
        background-color: rgb(200, 200, 200);
    }

    .budget-card, .new-card {
        border: 1px solid #ccc;
        border-radius: 18px;
        background: #fff;
        padding: 18px 20px 14px 20px;
        min-height: 140px;
        box-shadow: 1px 1px 10px rgba(0,0,0,0.10), -1px -1px 10px rgba(0,0,0,0.04);
        transition: background 0.18s, box-shadow 0.18s;
        margin-bottom: 3px;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        font-size:18px
    }
    .budget-card:hover, .new-card:hover {
        background: #f3fbff;
        box-shadow: 2px 4px 18px rgba(13,202,240,0.13);
    }
    .new-card {
        border: 2px dashed #aaa;
        background: #f7f7f7;
        color: #333;
        align-items: center;
        cursor: pointer;
    }
    .budget-card strong {
        font-size: 1.18em;
    }

    .expense-bar-bg {
        margin-top:8px;
        height:10px;
        background:#e1edf7;
        border-radius:6px;
        overflow:hidden;
    }

    .expense-bar-fill {
        background: linear-gradient(90deg, #0dcaf0 70%, #1bb8e8 100%);
        height: 100%;
        border-radius: 8px 0 0 8px;
        transition: width 0.45s;
    }

</style>


@Html.Partial("_Navbar")

<h2 class="name">All Budgets</h2>

<div class="container">
    <div class="row g-3">
        
        <div class="col-12 col-sm-6 col-md-4 col-lg-3">
            <a href="@Url.Action("Create")" style="text-decoration:none; color: inherit;">
                <div class="budget-card new-card h-100 d-flex flex-column justify-content-center align-items-center">
                    <span style="font-size:2rem;">+</span>
                    <p class="mb-0">Create a new budget</p>
                </div>
            </a>
        </div>
      
        @foreach (var item in Model)
        {


            var spent = item.Expenses?.Sum(e => (float?)e.Ammount) ?? 0;
            var remaining = item.Ammount - spent;
            var percentSpent = item.Ammount == 0 ? 0 : Math.Min((spent / (float)item.Ammount) * 100, 100);

            <div class="col-12 col-sm-6 col-md-4 col-lg-3">
                <a href="@Url.Action("Details",new {id = item.Id})" style="text-decoration:none; color: inherit;" >
                    <div class="budget-card h-100">
                        <div class="d-flex justify-content-between align-items-baseline mb-2">
                            <strong>@item.Name</strong>
                            <span style="font-size:1.2em;color:#0dcaf0;font-weight:600;">
                                $@item.Ammount.ToString("N0")
                            </span>
                        </div>
                        @if (item.Expenses.Count == 0)
                        {
                            <div>No expenses</div>
                        }
                        else
                        {
                            <div>@item.Expenses.Count expenses</div>
                        }

                        <div class="d-flex justify-content-between mt-3" style="font-weight:600;">
                            <span style="color:#222;">$@spent Spent</span>
                            <span style="color:#0dcaf0;">$@remaining.ToString("N0") Remaining</span>
                        </div>
                        @*<div style="margin-top:8px;height:10px;background:#e1edf7;border-radius:6px;overflow:hidden;">
                            <div style="width:100%;height:100%;background:#0dcaf0;"></div>
                        </div>*@

                        <div class="expense-bar-bg">
                            <div class="expense-bar-fill" style="width: @percentSpent%;"></div>
                        </div>

                    </div>
                </a>
            </div>
        }
    </div>
</div>

 






